

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Debugging ML-Matchers &#8212; py_entitymatching 0.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Triggers to Update Matching Results" href="triggers.html" />
    <link rel="prev" title="Selecting a ML-Matcher" href="select_best_matcher.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="triggers.html" title="Using Triggers to Update Matching Results"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="select_best_matcher.html" title="Selecting a ML-Matcher"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">py_entitymatching 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="steps_supp_em_workflows.html" accesskey="U">Steps of Supported EM Workflows</a> &#187;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <p class="caption"><span class="caption-text">How To Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_to_guide.html">How to Guide To Do Entity Matching</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatisnew.html">What is New?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of Supported EM Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastructures.html">Data Structures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="steps_supp_em_workflows.html">Steps of Supported EM Workflows</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="read_csv_files.html">Reading the CSV Files from Disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="down_sampling.html">Down Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_exploration.html">Data Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="blocking.html">Specifying Blockers and Performing Blocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_feats_for_blocking.html">Creating Features for Blocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging_blocking.html">Debugging Blocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampling.html">Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="labeling.html">Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="split_train_test.html">Splitting Labeled Data into Training and Testing Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_feats_for_matching.html">Creating Features for Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="extract_feat_vecs.html">Extracting Feature Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="imputing_missing_values.html">Imputing Missing Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="matching.html">Specifying Matchers and Performing Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="select_best_matcher.html">Selecting a ML-Matcher</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging ML-Matchers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#debugging-using-the-gui">Debugging Using the GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-using-the-command-line">Debugging Using the Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#impact-of-imputing-missing-values">Impact of Imputing Missing Values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="triggers.html">Using Triggers to Update Matching Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluate_matching.html">Evaluating the Matching Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/overview.html">Overview of Command Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/actual_commands.html">Commands in py_entitymatching</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="../search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="debugging-ml-matchers">
<h1>Debugging ML-Matchers<a class="headerlink" href="#debugging-ml-matchers" title="Permalink to this headline">¶</a></h1>
<p>While doing entity matching you would like to choose a matcher that produces the desired
precision, recall or F1 numbers. If a matcher does not produce the desired accuracy, then
you would like to debug the matcher. py_entitymatching supports two ways to
debug: (1) using the GUI, and (2) using the command line.</p>
<div class="section" id="debugging-using-the-gui">
<h2>Debugging Using the GUI<a class="headerlink" href="#debugging-using-the-gui" title="Permalink to this headline">¶</a></h2>
<p>py_entitymatching supports debugging using the GUI for a subset of ML-based matchers.
Specifically, it supports debugging Decision Tree matcher and Random Forest matcher.
You can use <cite>vis_debug_dt</cite> and <cite>vis_debug_rf</cite> to debug Decision Tree matcher
and Random Forest matcher respectively.</p>
<p>An example of using <cite>vis_debug_dt</cite> is shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">DTMatcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_test</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">split_train_test</span><span class="p">(</span><span class="n">devel</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span> <span class="n">train_test</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">em</span><span class="o">.</span><span class="n">vis_debug_dt</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">exclude_attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ltable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtable_id&#39;</span><span class="p">],</span> <span class="n">target_attr</span><span class="o">=</span><span class="s1">&#39;gold_labels&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The command would display a GUI containing evaluation summary and an option to see tuples
flagged as <cite>false positives</cite> or <cite>false negatives</cite>. If you select <cite>false positives</cite>
then false positive tuple pairs would be displayed in the adjoining window. Similarly,
if <cite>false negatives</cite> is selected then false negative tuple pairs would be
displayed. By default, <cite>false positives</cite> is selected.
Each tuple pair is displayed with two buttons: <cite>show</cite> and <cite>debug</cite>. If you click on
<cite>show</cite>, then individual tuples (of that tuple pair) are displayed in a separate window.
If you click on <cite>debug</cite>, then a window with individual tuples and the
path taken by the feature vector in the Decision Tree that leads to the predicted value
is displayed.</p>
<p>The usage of <cite>vis_debug_rf</cite> is same as <cite>vis_debug_dt</cite>. The command would display a GUI
similar to <cite>vis_debug_dt</cite>, except the debug window would list a set of trees. You can
expand each tree to see the path taken by the features in that tree.</p>
<p>Please refer to the API reference of <a class="reference internal" href="api/debugging_matcher.html#py_entitymatching.vis_debug_dt" title="py_entitymatching.vis_debug_dt"><code class="xref py py-meth docutils literal"><span class="pre">vis_debug_dt()</span></code></a> and
<a class="reference internal" href="api/debugging_matcher.html#py_entitymatching.vis_debug_rf" title="py_entitymatching.vis_debug_rf"><code class="xref py py-meth docutils literal"><span class="pre">vis_debug_rf()</span></code></a> for more details.</p>
<p>If you want to debug a Decision Tree matcher or Random Forest matcher using GUI,
then we recommend the following steps:</p>
<ol class="arabic simple">
<li>In the displayed GUI, check precision and recall numbers in evaluation summary.</li>
<li>If the user wants to improve precision, then he/she should choose to see false positives.</li>
<li>If the user wants to improve recall, then he/she should choose to see false negatives.</li>
<li>In the displayed (false positive/false negative) tuple pairs,
you can click on the <cite>show</cite> button to see the tuples from the left and right tables.</li>
<li>In the displayed (false positive/false negative) tuple pairs, you can choose a tuple
and click on the <cite>debug</cite> button to see the detailed evaluation path of that tuple.</li>
<li>Based on the input tuples, predicates at each node and the actual feature value,
you should decide on the next step. Some of the possible next steps are
cleaning  the input data, adding more features, adding more training data, trying a
different matcher, etc.</li>
</ol>
</div>
<div class="section" id="debugging-using-the-command-line">
<h2>Debugging Using the Command Line<a class="headerlink" href="#debugging-using-the-command-line" title="Permalink to this headline">¶</a></h2>
<p>Similar to debugging using the GUI, py_entitymatching supports command line debugging for two
ML matchers: Decision Tree and Random Forest. Currently, py_entitymatching  supports
command line debugging only using tuple pairs, other approaches are left for future work.</p>
<p>You can use <cite>debug_decisiontree_matcher</cite> and <cite>debug_randomforest_matcher</cite> to debug
Decision Tree matcher and Random Forest matcher respectively.</p>
<p>An example of using <cite>debug_decisiontree_matcher</cite> is shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">extract_feat_vecs</span><span class="p">(</span><span class="n">devel</span><span class="p">,</span> <span class="n">feat_table</span><span class="o">=</span><span class="n">match_f</span><span class="p">,</span> <span class="n">attrs_after</span><span class="o">=</span><span class="s1">&#39;gold_labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">DTMatcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">exclude_attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ltable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;gold_labels&#39;</span><span class="p">],</span> <span class="n">target_attr</span><span class="o">=</span><span class="s1">&#39;gold_labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">F</span><span class="p">,</span> <span class="n">exclude_attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ltable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;gold_labels&#39;</span><span class="p">],</span> <span class="n">target_attr</span><span class="o">=</span><span class="s1">&#39;gold_labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">em</span><span class="o">.</span><span class="n">debug_decisiontree_matcher</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">B</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">match_f</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">exclude_attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ltable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rtable_id&#39;</span><span class="p">,</span> <span class="s1">&#39;gold_labels&#39;</span><span class="p">],</span> <span class="n">target_attr</span><span class="o">=</span><span class="s1">&#39;gold_labels&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above, the debug command prints the path taken by the feature vector, its
evaluation status at each node and the actual feature value at each node.</p>
<p>The usage of <cite>debug_randomforest_matcher</cite> is same as <cite>debug_decisiontree_matcher</cite>.
Similar to <cite>debug_decisiontree_matcher</cite> command, it prints the path taken by the feature
vector, except that it displays the path taken in each tree of the Random Forest.</p>
<p>Please refer to the API reference of <a class="reference internal" href="api/debugging_matcher.html#py_entitymatching.debug_decisiontree_matcher" title="py_entitymatching.debug_decisiontree_matcher"><code class="xref py py-meth docutils literal"><span class="pre">debug_decisiontree_matcher()</span></code></a>
and <a class="reference internal" href="api/debugging_matcher.html#py_entitymatching.debug_randomforest_matcher" title="py_entitymatching.debug_randomforest_matcher"><code class="xref py py-meth docutils literal"><span class="pre">debug_randomforest_matcher()</span></code></a> for more details.</p>
<p>If you want to debug a Decision Tree matcher or Random
Forest matcher using the command line, then we recommend the following steps:</p>
<ol class="arabic simple">
<li>Evaluate the accuracy of predictions using user created labels. The evaluation can
be done using <a class="reference internal" href="api/evaluating_the_matching_output.html#py_entitymatching.eval_matches" title="py_entitymatching.eval_matches"><code class="xref py py-meth docutils literal"><span class="pre">eval_matches()</span></code></a> command.</li>
<li>If you want to improve precision, then he/she should debug false positives.</li>
<li>If you want to improve recall, then he/she should debug false negatives.</li>
<li>You should then retrieve the tuples from the tuple id pairs listed in evaluation
summary, and debug using the commands described above.</li>
<li>Based on the input tuples, predicates at each node and the actual feature value,
you should decide on the next step. Some of the possible next steps are clean
the input data, add more features, add more training data, try different matcher, etc.</li>
</ol>
</div>
<div class="section" id="impact-of-imputing-missing-values">
<h2>Impact of Imputing Missing Values<a class="headerlink" href="#impact-of-imputing-missing-values" title="Permalink to this headline">¶</a></h2>
<p>You should be aware of the following subtleties as it would
have an impact when he/she imputes values to feature vector set:</p>
<p>1. When you use the GUI for debugging, you would first choose to see
false positives/false negatives and then you would click the <cite>debug</cite> button to debug
that tuple pair. In this case, the feature vector in that row is given as input to find the path
traversed in the Decision Tree. If you had imputed the feature vector set to get
rid of NaN’s, then the imputed values would be considered to find the path traversed.</p>
<p>2. When you use the command line for debugging, then you would first evaluate the
predictions, select false positive or false negative tuple pairs to debug, retrieve the
tuples from the left and right tables and finally give them as input to command line
debugger commands. If you had imputed the feature vector set to get rid of NaN’s (using
a aggregate strategy), then imputed values would not be known to the debugger.</p>
<p>So if the input tables have NaN’s, then the output of the command line debugger would only
be partially correct (i.e., the displayed predicates would be correct, but the predicate
outcome may differ between current tuple pair and the actual feature vector used during
prediction).</p>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="triggers.html" title="Using Triggers to Update Matching Results"
             >next</a> |</li>
        <li class="right" >
          <a href="select_best_matcher.html" title="Selecting a ML-Matcher"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">py_entitymatching 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="steps_supp_em_workflows.html" >Steps of Supported EM Workflows</a> &#187;</li> 
      </ul>
    </div>
<style type="text/css">
    .scrollToTop {
        text-align: center;
        font-weight: bold;
        position: fixed;
        bottom: 60px;
        right: 40px;
        display: none;
    }
</style>
<a href="#" class="scrollToTop">Scroll To Top</a>
<script type="text/javascript">
$(document).ready(function() {
    //Check to see if the window is top if not then display button
    $(window).scroll(function() {
        if ($(this).scrollTop() > 200) {
            $('.scrollToTop').fadeIn();
        } else {
            $('.scrollToTop').fadeOut();
        }
    });

    //Click event to scroll to top
    $('.scrollToTop').click(function() {
        $('html, body').animate({
            scrollTop: 0
        }, 500);
        return false;
    });
});
</script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27880019-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </body>
</html>